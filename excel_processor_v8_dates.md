# Excel Mail Processor v8.1 - Поддержка обработки дат

## Обзор изменений

Добавлена поддержка корректной обработки колонок с датами в Excel файлах. Система теперь может автоматически распознавать и форматировать даты согласно заданным параметрам в инструкциях OneDrive.

## Ключевые улучшения

1. **Автоматическое распознавание дат** - система определяет колонки с датами по параметру `is_date`
2. **Гибкое форматирование** - поддержка различных форматов дат через параметр `date_format`
3. **Обратная совместимость** - изменения не влияют на существующую логику обработки
4. **Расширенные инструкции** - дополнительные параметры в листе 'columns' OneDrive

## Поддерживаемые форматы дат

- `DD.MM.YYYY` - 15.06.2025
- `DD/MM/YYYY` - 15/06/2025  
- `DD-MM-YYYY` - 15-06-2025
- `DD MMM YYYY` - 15 июн 2025
- `DD MMMM YYYY` - 15 июня 2025
- `YYYY-MM-DD` - 2025-06-15
- `MM/DD/YYYY` - 06/15/2025

## Структура расширенных инструкций

### Лист 'columns' в FGK.xlsx (OneDrive)

| source_name | target_name | action | value | is_date | date_format | date_locale |
|-------------|-------------|---------|-------|---------|-------------|-------------|
| Дата_отправления | Дата отправления | copy | | TRUE | DD.MM.YYYY | ru |
| Время_прибытия | Время прибытия | copy | | TRUE | DD MMM YYYY | ru |
| CreateDate | Дата создания | copy | | TRUE | YYYY-MM-DD | en |

### Новые параметры

- **is_date** (обязательный для дат): TRUE/FALSE - указывает что колонка содержит даты
- **date_format** (обязательный для дат): формат вывода даты  
- **date_locale** (опциональный): локаль для названий месяцев (по умолчанию 'ru')

## Примеры использования

### Базовая обработка дат
```
source_name: ДатаОтгрузки
target_name: Дата отгрузки  
action: copy
is_date: TRUE
date_format: DD.MM.YYYY
```

### Русские названия месяцев
```
source_name: DateShipped
target_name: Дата отправки
action: copy  
is_date: TRUE
date_format: DD MMMM YYYY
date_locale: ru
```

### Международный формат
```
source_name: CreatedDate
target_name: Created
action: copy
is_date: TRUE  
date_format: YYYY-MM-DD
date_locale: en
```